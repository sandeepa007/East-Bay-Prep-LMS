/*!
 * remark (http://getbootstrapadmin.com/remark)
 * Copyright 2018 amazingsurge
 * Licensed under the Themeforest Standard Licenses
 */

define(["jquery"],function(){function GridStackDragDropPlugin(grid){this.grid=grid}var scope=window,obsolete=function(f,oldName,newName){var wrapper=function(){return f.apply(this,arguments)};return wrapper.prototype=f.prototype,wrapper},obsoleteOpts=function(oldName,newName){},Utils={isIntercepted:function(a,b){return!(a.x+a.width<=b.x||b.x+b.width<=a.x||a.y+a.height<=b.y||b.y+b.height<=a.y)},sort:function(nodes,dir,width){return width=width||_.chain(nodes).map(function(node){return node.x+node.width}).max().value(),dir=-1!=dir?1:-1,_.sortBy(nodes,[function(n){return dir*(n.x+n.y*width)}])},createStylesheet:function(id){var style=document.createElement("style");return style.setAttribute("type","text/css"),style.setAttribute("data-gs-style-id",id),style.styleSheet?style.styleSheet.cssText="":style.appendChild(document.createTextNode("")),document.getElementsByTagName("head")[0].appendChild(style),style.sheet},removeStylesheet:function(id){$("STYLE[data-gs-style-id="+id+"]").remove()},insertCSSRule:function(sheet,selector,rules,index){"function"==typeof sheet.insertRule?sheet.insertRule(selector+"{"+rules+"}",index):"function"==typeof sheet.addRule&&sheet.addRule(selector,rules,index)},toBool:function(v){return"boolean"==typeof v?v:"string"==typeof v?!(""===(v=v.toLowerCase())||"no"==v||"false"==v||"0"==v):Boolean(v)},_collisionNodeCheck:function(n){return n!=this.node&&Utils.isIntercepted(n,this.nn)},_didCollide:function(bn){return Utils.isIntercepted({x:this.n.x,y:this.newY,width:this.n.width,height:this.n.height},bn)},_isAddNodeIntercepted:function(n){return Utils.isIntercepted({x:this.x,y:this.y,width:this.node.width,height:this.node.height},n)},parseHeight:function(val){var height=val,heightUnit="px";if(height&&_.isString(height)){var match=height.match(/^(-[0-9]+\.[0-9]+|[0-9]*\.[0-9]+|-[0-9]+|[0-9]+)(px|em|rem|vh|vw)?$/);if(!match)throw new Error("Invalid height");heightUnit=match[2]||"px",height=parseFloat(match[1])}return{height:height,unit:heightUnit}},removePositioningStyles:function(el){var style=el[0].style;style.position&&style.removeProperty("position"),style.left&&style.removeProperty("left"),style.top&&style.removeProperty("top"),style.width&&style.removeProperty("width"),style.height&&style.removeProperty("height")},getScrollParent:function(el){return null==el?null:el.scrollHeight>el.clientHeight?el:Utils.getScrollParent(el.parentNode)},updateScrollPosition:function(el,ui,distance){var rect=el.getBoundingClientRect(),innerHeightOrClientHeight=window.innerHeight||document.documentElement.clientHeight;if(rect.top<0||rect.bottom>innerHeightOrClientHeight){var offsetDiffDown=rect.bottom-innerHeightOrClientHeight,offsetDiffUp=rect.top,scrollEl=Utils.getScrollParent(el),prevScroll=scrollEl.scrollTop;null!=scrollEl&&(rect.top<0&&distance<0?el.offsetHeight>innerHeightOrClientHeight?scrollEl.scrollTop+=distance:scrollEl.scrollTop+=Math.abs(offsetDiffUp)>Math.abs(distance)?distance:offsetDiffUp:distance>0&&(el.offsetHeight>innerHeightOrClientHeight?scrollEl.scrollTop+=distance:scrollEl.scrollTop+=offsetDiffDown>distance?distance:offsetDiffDown),ui.position.top+=scrollEl.scrollTop-prevScroll)}}};Utils.is_intercepted=obsolete(Utils.isIntercepted),Utils.create_stylesheet=obsolete(Utils.createStylesheet),Utils.remove_stylesheet=obsolete(Utils.removeStylesheet),Utils.insert_css_rule=obsolete(Utils.insertCSSRule),GridStackDragDropPlugin.registeredPlugins=[],GridStackDragDropPlugin.registerPlugin=function(pluginClass){GridStackDragDropPlugin.registeredPlugins.push(pluginClass)},GridStackDragDropPlugin.prototype.resizable=function(el,opts){return this},GridStackDragDropPlugin.prototype.draggable=function(el,opts){return this},GridStackDragDropPlugin.prototype.droppable=function(el,opts){return this},GridStackDragDropPlugin.prototype.isDroppable=function(el){return!1},GridStackDragDropPlugin.prototype.on=function(el,eventName,callback){return this};var idSeq=0,GridStackEngine=function(width,onchange,floatMode,height,items){this.width=width,this.float=floatMode||!1,this.height=height||0,this.nodes=items||[],this.onchange=onchange||function(){},this._updateCounter=0,this._float=this.float,this._addedNodes=[],this._removedNodes=[]};GridStackEngine.prototype.batchUpdate=function(){this._updateCounter=1,this.float=!0},GridStackEngine.prototype.commit=function(){0!==this._updateCounter&&(this._updateCounter=0,this.float=this._float,this._packNodes(),this._notify())},GridStackEngine.prototype.getNodeDataByDOMEl=function(el){return _.find(this.nodes,function(n){return el.get(0)===n.el.get(0)})},GridStackEngine.prototype._fixCollisions=function(node){this._sortNodes(-1);var nn=node,hasLocked=Boolean(_.find(this.nodes,function(n){return n.locked}));for(this.float||hasLocked||(nn={x:0,y:node.y,width:this.width,height:node.height});;){var collisionNode=_.find(this.nodes,_.bind(Utils._collisionNodeCheck,{node:node,nn:nn}));if(void 0===collisionNode)return;this.moveNode(collisionNode,collisionNode.x,node.y+node.height,collisionNode.width,collisionNode.height,!0)}},GridStackEngine.prototype.isAreaEmpty=function(x,y,width,height){var nn={x:x||0,y:y||0,width:width||1,height:height||1},collisionNode=_.find(this.nodes,_.bind(function(n){return Utils.isIntercepted(n,nn)},this));return null===collisionNode||void 0===collisionNode},GridStackEngine.prototype._sortNodes=function(dir){this.nodes=Utils.sort(this.nodes,dir,this.width)},GridStackEngine.prototype._packNodes=function(){this._sortNodes(),this.float?_.each(this.nodes,_.bind(function(n,i){if(!n._updating&&void 0!==n._origY&&n.y!=n._origY)for(var newY=n.y;newY>=n._origY;)_.chain(this.nodes).take(i).find(_.bind(Utils._didCollide,{n:n,newY:newY})).value()||(n._dirty=!0,n.y=newY),--newY},this)):_.each(this.nodes,_.bind(function(n,i){if(!n.locked)for(;n.y>0;){var newY=n.y-1,canBeMoved=0===i;if(i>0&&(canBeMoved=void 0===_.chain(this.nodes).take(i).find(_.bind(Utils._didCollide,{n:n,newY:newY})).value()),!canBeMoved)break;n._dirty=n.y!=newY,n.y=newY}},this))},GridStackEngine.prototype._prepareNode=function(node,resizing){return node=_.defaults(node||{},{width:1,height:1,x:0,y:0}),node.x=parseInt(""+node.x),node.y=parseInt(""+node.y),node.width=parseInt(""+node.width),node.height=parseInt(""+node.height),node.autoPosition=node.autoPosition||!1,node.noResize=node.noResize||!1,node.noMove=node.noMove||!1,node.width>this.width?node.width=this.width:node.width<1&&(node.width=1),node.height<1&&(node.height=1),node.x<0&&(node.x=0),node.x+node.width>this.width&&(resizing?node.width=this.width-node.x:node.x=this.width-node.width),node.y<0&&(node.y=0),node},GridStackEngine.prototype._notify=function(){var args=Array.prototype.slice.call(arguments,0);if(args[0]=void 0===args[0]?[]:[args[0]],args[1]=void 0===args[1]||args[1],!this._updateCounter){var deletedNodes=args[0].concat(this.getDirtyNodes());this.onchange(deletedNodes,args[1])}},GridStackEngine.prototype.cleanNodes=function(){this._updateCounter||_.each(this.nodes,function(n){n._dirty=!1})},GridStackEngine.prototype.getDirtyNodes=function(){return _.filter(this.nodes,function(n){return n._dirty})},GridStackEngine.prototype.addNode=function(node,triggerAddEvent){if(void 0!==(node=this._prepareNode(node)).maxWidth&&(node.width=Math.min(node.width,node.maxWidth)),void 0!==node.maxHeight&&(node.height=Math.min(node.height,node.maxHeight)),void 0!==node.minWidth&&(node.width=Math.max(node.width,node.minWidth)),void 0!==node.minHeight&&(node.height=Math.max(node.height,node.minHeight)),node._id=++idSeq,node._dirty=!0,node.autoPosition){this._sortNodes();for(var i=0;;++i){var x=i%this.width,y=Math.floor(i/this.width);if(!(x+node.width>this.width)&&!_.find(this.nodes,_.bind(Utils._isAddNodeIntercepted,{x:x,y:y,node:node}))){node.x=x,node.y=y;break}}}return this.nodes.push(node),void 0!==triggerAddEvent&&triggerAddEvent&&this._addedNodes.push(_.clone(node)),this._fixCollisions(node),this._packNodes(),this._notify(),node},GridStackEngine.prototype.removeNode=function(node,detachNode){detachNode=void 0===detachNode||detachNode,this._removedNodes.push(_.clone(node)),node._id=null,this.nodes=_.without(this.nodes,node),this._packNodes(),this._notify(node,detachNode)},GridStackEngine.prototype.canMoveNode=function(node,x,y,width,height){if(!this.isNodeChangedPosition(node,x,y,width,height))return!1;var hasLocked=Boolean(_.find(this.nodes,function(n){return n.locked}));if(!this.height&&!hasLocked)return!0;var clonedNode,clone=new GridStackEngine(this.width,null,this.float,0,_.map(this.nodes,function(n){return n==node?clonedNode=$.extend({},n):$.extend({},n)}));if(void 0===clonedNode)return!0;clone.moveNode(clonedNode,x,y,width,height);var res=!0;return hasLocked&&(res&=!Boolean(_.find(clone.nodes,function(n){return n!=clonedNode&&Boolean(n.locked)&&Boolean(n._dirty)}))),this.height&&(res&=clone.getGridHeight()<=this.height),res},GridStackEngine.prototype.canBePlacedWithRespectToHeight=function(node){if(!this.height)return!0;var clone=new GridStackEngine(this.width,null,this.float,0,_.map(this.nodes,function(n){return $.extend({},n)}));return clone.addNode(node),clone.getGridHeight()<=this.height},GridStackEngine.prototype.isNodeChangedPosition=function(node,x,y,width,height){return"number"!=typeof x&&(x=node.x),"number"!=typeof y&&(y=node.y),"number"!=typeof width&&(width=node.width),"number"!=typeof height&&(height=node.height),void 0!==node.maxWidth&&(width=Math.min(width,node.maxWidth)),void 0!==node.maxHeight&&(height=Math.min(height,node.maxHeight)),void 0!==node.minWidth&&(width=Math.max(width,node.minWidth)),void 0!==node.minHeight&&(height=Math.max(height,node.minHeight)),node.x!=x||node.y!=y||node.width!=width||node.height!=height},GridStackEngine.prototype.moveNode=function(node,x,y,width,height,noPack){if(!this.isNodeChangedPosition(node,x,y,width,height))return node;if("number"!=typeof x&&(x=node.x),"number"!=typeof y&&(y=node.y),"number"!=typeof width&&(width=node.width),"number"!=typeof height&&(height=node.height),void 0!==node.maxWidth&&(width=Math.min(width,node.maxWidth)),void 0!==node.maxHeight&&(height=Math.min(height,node.maxHeight)),void 0!==node.minWidth&&(width=Math.max(width,node.minWidth)),void 0!==node.minHeight&&(height=Math.max(height,node.minHeight)),node.x==x&&node.y==y&&node.width==width&&node.height==height)return node;var resizing=node.width!=width;return node._dirty=!0,node.x=x,node.y=y,node.width=width,node.height=height,node.lastTriedX=x,node.lastTriedY=y,node.lastTriedWidth=width,node.lastTriedHeight=height,node=this._prepareNode(node,resizing),this._fixCollisions(node),noPack||(this._packNodes(),this._notify()),node},GridStackEngine.prototype.getGridHeight=function(){return _.reduce(this.nodes,function(memo,n){return Math.max(memo,n.y+n.height)},0)},GridStackEngine.prototype.beginUpdate=function(node){_.each(this.nodes,function(n){n._origY=n.y}),node._updating=!0},GridStackEngine.prototype.endUpdate=function(){_.each(this.nodes,function(n){n._origY=n.y});var n=_.find(this.nodes,function(n){return n._updating});n&&(n._updating=!1)};var GridStack=function(el,opts){var oneColumnMode,isAutoCellHeight,self=this;opts=opts||{},this.container=$(el),void 0!==opts.handle_class&&(opts.handleClass=opts.handle_class,obsoleteOpts()),void 0!==opts.item_class&&(opts.itemClass=opts.item_class,obsoleteOpts()),void 0!==opts.placeholder_class&&(opts.placeholderClass=opts.placeholder_class,obsoleteOpts()),void 0!==opts.placeholder_text&&(opts.placeholderText=opts.placeholder_text,obsoleteOpts()),void 0!==opts.cell_height&&(opts.cellHeight=opts.cell_height,obsoleteOpts()),void 0!==opts.vertical_margin&&(opts.verticalMargin=opts.vertical_margin,obsoleteOpts()),void 0!==opts.min_width&&(opts.minWidth=opts.min_width,obsoleteOpts()),void 0!==opts.static_grid&&(opts.staticGrid=opts.static_grid,obsoleteOpts()),void 0!==opts.is_nested&&(opts.isNested=opts.is_nested,obsoleteOpts()),void 0!==opts.always_show_resize_handle&&(opts.alwaysShowResizeHandle=opts.always_show_resize_handle,obsoleteOpts()),opts.itemClass=opts.itemClass||"grid-stack-item";var isNested=this.container.closest("."+opts.itemClass).length>0;if(this.opts=_.defaults(opts||{},{width:parseInt(this.container.attr("data-gs-width"))||12,height:parseInt(this.container.attr("data-gs-height"))||0,itemClass:"grid-stack-item",placeholderClass:"grid-stack-placeholder",placeholderText:"",handle:".grid-stack-item-content",handleClass:null,cellHeight:60,verticalMargin:20,auto:!0,minWidth:768,float:!1,staticGrid:!1,_class:"grid-stack-instance-"+(1e4*Math.random()).toFixed(0),animate:Boolean(this.container.attr("data-gs-animate"))||!1,alwaysShowResizeHandle:opts.alwaysShowResizeHandle||!1,resizable:_.defaults(opts.resizable||{},{autoHide:!opts.alwaysShowResizeHandle,handles:"se"}),draggable:_.defaults(opts.draggable||{},{handle:(opts.handleClass?"."+opts.handleClass:opts.handle?opts.handle:"")||".grid-stack-item-content",scroll:!1,appendTo:"body"}),disableDrag:opts.disableDrag||!1,disableResize:opts.disableResize||!1,rtl:"auto",removable:!1,removableOptions:_.defaults(opts.removableOptions||{},{accept:"."+opts.itemClass}),removeTimeout:2e3,verticalMarginUnit:"px",cellHeightUnit:"px",disableOneColumnMode:opts.disableOneColumnMode||!1,oneColumnModeClass:opts.oneColumnModeClass||"grid-stack-one-column-mode",ddPlugin:null}),!1===this.opts.ddPlugin?this.opts.ddPlugin=GridStackDragDropPlugin:null===this.opts.ddPlugin&&(this.opts.ddPlugin=_.first(GridStackDragDropPlugin.registeredPlugins)||GridStackDragDropPlugin),this.dd=new this.opts.ddPlugin(this),"auto"===this.opts.rtl&&(this.opts.rtl="rtl"===this.container.css("direction")),this.opts.rtl&&this.container.addClass("grid-stack-rtl"),this.opts.isNested=isNested,(isAutoCellHeight="auto"===this.opts.cellHeight)?self.cellHeight(self.cellWidth(),!0):this.cellHeight(this.opts.cellHeight,!0),this.verticalMargin(this.opts.verticalMargin,!0),this.container.addClass(this.opts._class),this._setStaticClass(),isNested&&this.container.addClass("grid-stack-nested"),this._initStyles(),this.grid=new GridStackEngine(this.opts.width,function(nodes,detachNode){detachNode=void 0===detachNode||detachNode;var maxHeight=0;_.each(this.nodes,function(n){maxHeight=Math.max(maxHeight,n.y+n.height)}),_.each(nodes,function(n){detachNode&&null===n._id?n.el&&n.el.remove():n.el.attr("data-gs-x",n.x).attr("data-gs-y",n.y).attr("data-gs-width",n.width).attr("data-gs-height",n.height)}),self._updateStyles(maxHeight+10)},this.opts.float,this.opts.height),this.opts.auto){var elements=[],_this=this;this.container.children("."+this.opts.itemClass+":not(."+this.opts.placeholderClass+")").each(function(index,el){el=$(el),elements.push({el:el,i:parseInt(el.attr("data-gs-x"))+parseInt(el.attr("data-gs-y"))*_this.opts.width})}),_.chain(elements).sortBy(function(x){return x.i}).each(function(i){self._prepareElement(i.el)}).value()}if(this.setAnimation(this.opts.animate),this.placeholder=$('<div class="'+this.opts.placeholderClass+" "+this.opts.itemClass+'"><div class="placeholder-content">'+this.opts.placeholderText+"</div></div>").hide(),this._updateContainerHeight(),this._updateHeightsOnResize=_.throttle(function(){self.cellHeight(self.cellWidth(),!1)},100),this.onResizeHandler=function(){if(isAutoCellHeight&&self._updateHeightsOnResize(),self._isOneColumnMode()&&!self.opts.disableOneColumnMode){if(oneColumnMode)return;self.container.addClass(self.opts.oneColumnModeClass),oneColumnMode=!0,self.grid._sortNodes(),_.each(self.grid.nodes,function(node){self.container.append(node.el),self.opts.staticGrid||(self.dd.draggable(node.el,"disable"),self.dd.resizable(node.el,"disable"),node.el.trigger("resize"))})}else{if(!oneColumnMode)return;if(self.container.removeClass(self.opts.oneColumnModeClass),oneColumnMode=!1,self.opts.staticGrid)return;_.each(self.grid.nodes,function(node){node.noMove||self.opts.disableDrag||self.dd.draggable(node.el,"enable"),node.noResize||self.opts.disableResize||self.dd.resizable(node.el,"enable"),node.el.trigger("resize")})}},$(window).resize(this.onResizeHandler),this.onResizeHandler(),!self.opts.staticGrid&&"string"==typeof self.opts.removable){var trashZone=$(self.opts.removable);this.dd.isDroppable(trashZone)||this.dd.droppable(trashZone,self.opts.removableOptions),this.dd.on(trashZone,"dropover",function(event,ui){var el=$(ui.draggable);el.data("_gridstack_node")._grid===self&&(el.data("inTrashZone",!0),self._setupRemovingTimeout(el))}).on(trashZone,"dropout",function(event,ui){var el=$(ui.draggable);el.data("_gridstack_node")._grid===self&&(el.data("inTrashZone",!1),self._clearRemovingTimeout(el))})}if(!self.opts.staticGrid&&self.opts.acceptWidgets){var draggingElement=null,onDrag=function(event,ui){var el=draggingElement,node=el.data("_gridstack_node"),pos=self.getCellFromPixel({left:event.pageX,top:event.pageY},!0),x=Math.max(0,pos.x),y=Math.max(0,pos.y);node._added||(node._added=!0,node.el=el,node.autoPosition=!0,node.x=x,node.y=y,self.grid.cleanNodes(),self.grid.beginUpdate(node),self.grid.addNode(node),self.container.append(self.placeholder),self.placeholder.attr("data-gs-x",node.x).attr("data-gs-y",node.y).attr("data-gs-width",node.width).attr("data-gs-height",node.height).show(),node.el=self.placeholder,node._beforeDragX=node.x,node._beforeDragY=node.y,self._updateContainerHeight()),self.grid.canMoveNode(node,x,y)&&(self.grid.moveNode(node,x,y),self._updateContainerHeight())};this.dd.droppable(self.container,{accept:function(el){var node=(el=$(el)).data("_gridstack_node");return(!node||node._grid!==self)&&el.is(!0===self.opts.acceptWidgets?".grid-stack-item":self.opts.acceptWidgets)}}).on(self.container,"dropover",function(event,ui){self.container.offset();var el=$(ui.draggable),cellWidth=self.cellWidth(),cellHeight=self.cellHeight(),origNode=el.data("_gridstack_node"),width=origNode?origNode.width:Math.ceil(el.outerWidth()/cellWidth),height=origNode?origNode.height:Math.ceil(el.outerHeight()/cellHeight);draggingElement=el;var node=self.grid._prepareNode({width:width,height:height,_added:!1,_temporary:!0});el.data("_gridstack_node",node),el.data("_gridstack_node_orig",origNode),el.on("drag",onDrag)}).on(self.container,"dropout",function(event,ui){var el=$(ui.draggable);if(el.data("_gridstack_node")){el.unbind("drag",onDrag);var node=el.data("_gridstack_node");node.el=null,self.grid.removeNode(node),self.placeholder.detach(),self._updateContainerHeight(),el.data("_gridstack_node",el.data("_gridstack_node_orig"))}}).on(self.container,"drop",function(event,ui){self.placeholder.detach();var node=$(ui.draggable).data("_gridstack_node");node._grid=self;var el=$(ui.draggable).clone(!1);el.data("_gridstack_node",node);var originalNode=$(ui.draggable).data("_gridstack_node_orig");void 0!==originalNode&&void 0!==originalNode._grid&&originalNode._grid._triggerRemoveEvent(),$(ui.helper).remove(),node.el=el,self.placeholder.hide(),Utils.removePositioningStyles(el),el.find("div.ui-resizable-handle").remove(),el.attr("data-gs-x",node.x).attr("data-gs-y",node.y).attr("data-gs-width",node.width).attr("data-gs-height",node.height).addClass(self.opts.itemClass).enableSelection().removeData("draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled").unbind("drag",onDrag),self.container.append(el),self._prepareElementsByNode(el,node),self._updateContainerHeight(),self.grid._addedNodes.push(node),self._triggerAddEvent(),self._triggerChangeEvent(),self.grid.endUpdate(),$(ui.draggable).unbind("drag",onDrag),$(ui.draggable).removeData("_gridstack_node"),$(ui.draggable).removeData("_gridstack_node_orig")})}};return GridStack.prototype._triggerChangeEvent=function(forceTrigger){var elements=this.grid.getDirtyNodes(),hasChanges=!1,eventParams=[];elements&&elements.length&&(eventParams.push(elements),hasChanges=!0),(hasChanges||!0===forceTrigger)&&this.container.trigger("change",eventParams)},GridStack.prototype._triggerAddEvent=function(){this.grid._addedNodes&&this.grid._addedNodes.length>0&&(this.container.trigger("added",[_.map(this.grid._addedNodes,_.clone)]),this.grid._addedNodes=[])},GridStack.prototype._triggerRemoveEvent=function(){this.grid._removedNodes&&this.grid._removedNodes.length>0&&(this.container.trigger("removed",[_.map(this.grid._removedNodes,_.clone)]),this.grid._removedNodes=[])},GridStack.prototype._initStyles=function(){this._stylesId&&Utils.removeStylesheet(this._stylesId),this._stylesId="gridstack-style-"+(1e5*Math.random()).toFixed(),this._styles=Utils.createStylesheet(this._stylesId),null!==this._styles&&(this._styles._max=0)},GridStack.prototype._updateStyles=function(maxHeight){if(null!==this._styles&&void 0!==this._styles){var getHeight,prefix="."+this.opts._class+" ."+this.opts.itemClass,self=this;if(void 0===maxHeight&&(maxHeight=this._styles._max),this._initStyles(),this._updateContainerHeight(),this.opts.cellHeight&&!(0!==this._styles._max&&maxHeight<=this._styles._max)&&(getHeight=this.opts.verticalMargin&&this.opts.cellHeightUnit!==this.opts.verticalMarginUnit?function(nbRows,nbMargins){return nbRows&&nbMargins?"calc("+(self.opts.cellHeight*nbRows+self.opts.cellHeightUnit)+" + "+(self.opts.verticalMargin*nbMargins+self.opts.verticalMarginUnit)+")":self.opts.cellHeight*nbRows+self.opts.verticalMargin*nbMargins+self.opts.cellHeightUnit}:function(nbRows,nbMargins){return self.opts.cellHeight*nbRows+self.opts.verticalMargin*nbMargins+self.opts.cellHeightUnit},0===this._styles._max&&Utils.insertCSSRule(this._styles,prefix,"min-height: "+getHeight(1,0)+";",0),maxHeight>this._styles._max)){for(var i=this._styles._max;i<maxHeight;++i)Utils.insertCSSRule(this._styles,prefix+'[data-gs-height="'+(i+1)+'"]',"height: "+getHeight(i+1,i)+";",i),Utils.insertCSSRule(this._styles,prefix+'[data-gs-min-height="'+(i+1)+'"]',"min-height: "+getHeight(i+1,i)+";",i),Utils.insertCSSRule(this._styles,prefix+'[data-gs-max-height="'+(i+1)+'"]',"max-height: "+getHeight(i+1,i)+";",i),Utils.insertCSSRule(this._styles,prefix+'[data-gs-y="'+i+'"]',"top: "+getHeight(i,i)+";",i);this._styles._max=maxHeight}}},GridStack.prototype._updateContainerHeight=function(){if(!this.grid._updateCounter){var height=this.grid.getGridHeight(),cssMinHeight=parseInt(this.container.css("min-height"));if(cssMinHeight>0){var minHeight=(cssMinHeight+this.opts.verticalMargin)/(this.cellHeight()+this.opts.verticalMargin);height<minHeight&&(height=minHeight)}this.container.attr("data-gs-current-height",height),this.opts.cellHeight&&(this.opts.verticalMargin?this.opts.cellHeightUnit===this.opts.verticalMarginUnit?this.container.css("height",height*(this.opts.cellHeight+this.opts.verticalMargin)-this.opts.verticalMargin+this.opts.cellHeightUnit):this.container.css("height","calc("+(height*this.opts.cellHeight+this.opts.cellHeightUnit)+" + "+(height*(this.opts.verticalMargin-1)+this.opts.verticalMarginUnit)+")"):this.container.css("height",height*this.opts.cellHeight+this.opts.cellHeightUnit))}},GridStack.prototype._isOneColumnMode=function(){return(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<=this.opts.minWidth},GridStack.prototype._setupRemovingTimeout=function(el){var self=this,node=$(el).data("_gridstack_node");!node._removeTimeout&&self.opts.removable&&(node._removeTimeout=setTimeout(function(){el.addClass("grid-stack-item-removing"),node._isAboutToRemove=!0},self.opts.removeTimeout))},GridStack.prototype._clearRemovingTimeout=function(el){var node=$(el).data("_gridstack_node");node._removeTimeout&&(clearTimeout(node._removeTimeout),node._removeTimeout=null,el.removeClass("grid-stack-item-removing"),node._isAboutToRemove=!1)},GridStack.prototype._prepareElementsByNode=function(el,node){var cellWidth,cellHeight,self=this,dragOrResize=function(event,ui){var width,height,x=Math.round(ui.position.left/cellWidth),y=Math.floor((ui.position.top+cellHeight/2)/cellHeight);if("drag"!=event.type&&(width=Math.round(ui.size.width/cellWidth),height=Math.round(ui.size.height/cellHeight)),"drag"==event.type){var distance=ui.position.top-node._prevYPix;node._prevYPix=ui.position.top,Utils.updateScrollPosition(el[0],ui,distance),el.data("inTrashZone")||x<0||x>=self.grid.width||y<0||!self.grid.float&&y>self.grid.getGridHeight()?node._temporaryRemoved||(!0===self.opts.removable&&self._setupRemovingTimeout(el),x=node._beforeDragX,y=node._beforeDragY,self.placeholder.detach(),self.placeholder.hide(),self.grid.removeNode(node),self._updateContainerHeight(),node._temporaryRemoved=!0):(self._clearRemovingTimeout(el),node._temporaryRemoved&&(self.grid.addNode(node),self.placeholder.attr("data-gs-x",x).attr("data-gs-y",y).attr("data-gs-width",width).attr("data-gs-height",height).show(),self.container.append(self.placeholder),node.el=self.placeholder,node._temporaryRemoved=!1))}else if("resize"==event.type&&x<0)return;var lastTriedWidth=void 0!==width?width:node.lastTriedWidth,lastTriedHeight=void 0!==height?height:node.lastTriedHeight;!self.grid.canMoveNode(node,x,y,width,height)||node.lastTriedX===x&&node.lastTriedY===y&&node.lastTriedWidth===lastTriedWidth&&node.lastTriedHeight===lastTriedHeight||(node.lastTriedX=x,node.lastTriedY=y,node.lastTriedWidth=width,node.lastTriedHeight=height,self.grid.moveNode(node,x,y,width,height),self._updateContainerHeight())},onStartMoving=function(event,ui){self.container.append(self.placeholder);var o=$(this);self.grid.cleanNodes(),self.grid.beginUpdate(node),cellWidth=self.cellWidth();var strictCellHeight=Math.ceil(o.outerHeight()/o.attr("data-gs-height"));cellHeight=self.container.height()/parseInt(self.container.attr("data-gs-current-height")),self.placeholder.attr("data-gs-x",o.attr("data-gs-x")).attr("data-gs-y",o.attr("data-gs-y")).attr("data-gs-width",o.attr("data-gs-width")).attr("data-gs-height",o.attr("data-gs-height")).show(),node.el=self.placeholder,node._beforeDragX=node.x,node._beforeDragY=node.y,node._prevYPix=ui.position.top,self.dd.resizable(el,"option","minWidth",cellWidth*(node.minWidth||1)),self.dd.resizable(el,"option","minHeight",strictCellHeight*(node.minHeight||1)),"resizestart"==event.type&&o.find(".grid-stack-item").trigger("resizestart")},onEndMoving=function(event,ui){var o=$(this);if(o.data("_gridstack_node")){var forceNotify=!1;self.placeholder.detach(),node.el=o,self.placeholder.hide(),node._isAboutToRemove?(forceNotify=!0,el.data("_gridstack_node")._grid._triggerRemoveEvent(),el.removeData("_gridstack_node"),el.remove()):(self._clearRemovingTimeout(el),node._temporaryRemoved?(Utils.removePositioningStyles(o),o.attr("data-gs-x",node._beforeDragX).attr("data-gs-y",node._beforeDragY).attr("data-gs-width",node.width).attr("data-gs-height",node.height),node.x=node._beforeDragX,node.y=node._beforeDragY,node._temporaryRemoved=!1,self.grid.addNode(node)):(Utils.removePositioningStyles(o),o.attr("data-gs-x",node.x).attr("data-gs-y",node.y).attr("data-gs-width",node.width).attr("data-gs-height",node.height))),self._updateContainerHeight(),self._triggerChangeEvent(forceNotify),self.grid.endUpdate();var nestedGrids=o.find(".grid-stack");nestedGrids.length&&"resizestop"==event.type&&(nestedGrids.each(function(index,el){$(el).data("gridstack").onResizeHandler()}),o.find(".grid-stack-item").trigger("resizestop"),o.find(".grid-stack-item").trigger("gsresizestop")),"resizestop"==event.type&&self.container.trigger("gsresizestop",o)}};this.dd.draggable(el,{start:onStartMoving,stop:onEndMoving,drag:dragOrResize}).resizable(el,{start:onStartMoving,stop:onEndMoving,resize:dragOrResize}),(node.noMove||this._isOneColumnMode()&&!self.opts.disableOneColumnMode||this.opts.disableDrag||this.opts.staticGrid)&&this.dd.draggable(el,"disable"),(node.noResize||this._isOneColumnMode()&&!self.opts.disableOneColumnMode||this.opts.disableResize||this.opts.staticGrid)&&this.dd.resizable(el,"disable"),el.attr("data-gs-locked",node.locked?"yes":null)},GridStack.prototype._prepareElement=function(el,triggerAddEvent){triggerAddEvent=void 0!==triggerAddEvent&&triggerAddEvent;var self=this;(el=$(el)).addClass(this.opts.itemClass);var node=self.grid.addNode({x:parseInt(el.attr("data-gs-x"),10),y:parseInt(el.attr("data-gs-y"),10),width:el.attr("data-gs-width"),height:el.attr("data-gs-height"),maxWidth:el.attr("data-gs-max-width"),minWidth:el.attr("data-gs-min-width"),maxHeight:el.attr("data-gs-max-height"),minHeight:el.attr("data-gs-min-height"),autoPosition:Utils.toBool(el.attr("data-gs-auto-position")),noResize:Utils.toBool(el.attr("data-gs-no-resize")),noMove:Utils.toBool(el.attr("data-gs-no-move")),locked:Utils.toBool(el.attr("data-gs-locked")),resizeHandles:el.attr("data-gs-resize-handles"),el:el,id:el.attr("data-gs-id"),_grid:self},triggerAddEvent);el.data("_gridstack_node",node),this._prepareElementsByNode(el,node)},GridStack.prototype.setAnimation=function(enable){enable?this.container.addClass("grid-stack-animate"):this.container.removeClass("grid-stack-animate")},GridStack.prototype.addWidget=function(el,x,y,width,height,autoPosition,minWidth,maxWidth,minHeight,maxHeight,id){return el=$(el),void 0!==x&&el.attr("data-gs-x",x),void 0!==y&&el.attr("data-gs-y",y),void 0!==width&&el.attr("data-gs-width",width),void 0!==height&&el.attr("data-gs-height",height),void 0!==autoPosition&&el.attr("data-gs-auto-position",autoPosition?"yes":null),void 0!==minWidth&&el.attr("data-gs-min-width",minWidth),void 0!==maxWidth&&el.attr("data-gs-max-width",maxWidth),void 0!==minHeight&&el.attr("data-gs-min-height",minHeight),void 0!==maxHeight&&el.attr("data-gs-max-height",maxHeight),void 0!==id&&el.attr("data-gs-id",id),this.container.append(el),this._prepareElement(el,!0),this._triggerAddEvent(),this._updateContainerHeight(),this._triggerChangeEvent(!0),el},GridStack.prototype.makeWidget=function(el){return el=$(el),this._prepareElement(el,!0),this._triggerAddEvent(),this._updateContainerHeight(),this._triggerChangeEvent(!0),el},GridStack.prototype.willItFit=function(x,y,width,height,autoPosition){var node={x:x,y:y,width:width,height:height,autoPosition:autoPosition};return this.grid.canBePlacedWithRespectToHeight(node)},GridStack.prototype.removeWidget=function(el,detachNode){detachNode=void 0===detachNode||detachNode;var node=(el=$(el)).data("_gridstack_node");node||(node=this.grid.getNodeDataByDOMEl(el)),this.grid.removeNode(node,detachNode),el.removeData("_gridstack_node"),this._updateContainerHeight(),detachNode&&el.remove(),this._triggerChangeEvent(!0),this._triggerRemoveEvent()},GridStack.prototype.removeAll=function(detachNode){_.each(this.grid.nodes,_.bind(function(node){this.removeWidget(node.el,detachNode)},this)),this.grid.nodes=[],this._updateContainerHeight()},GridStack.prototype.destroy=function(detachGrid){$(window).off("resize",this.onResizeHandler),this.disable(),void 0===detachGrid||detachGrid?this.container.remove():(this.removeAll(!1),this.container.removeData("gridstack")),Utils.removeStylesheet(this._stylesId),this.grid&&(this.grid=null)},GridStack.prototype.resizable=function(el,val){var self=this;return(el=$(el)).each(function(index,el){var node=(el=$(el)).data("_gridstack_node");void 0!==node&&null!==node&&(node.noResize=!val,node.noResize||self._isOneColumnMode()&&!self.opts.disableOneColumnMode?self.dd.resizable(el,"disable"):self.dd.resizable(el,"enable"))}),this},GridStack.prototype.movable=function(el,val){var self=this;return(el=$(el)).each(function(index,el){var node=(el=$(el)).data("_gridstack_node");void 0!==node&&null!==node&&(node.noMove=!val,node.noMove||self._isOneColumnMode()&&!self.opts.disableOneColumnMode?(self.dd.draggable(el,"disable"),el.removeClass("ui-draggable-handle")):(self.dd.draggable(el,"enable"),el.addClass("ui-draggable-handle")))}),this},GridStack.prototype.enableMove=function(doEnable,includeNewWidgets){this.movable(this.container.children("."+this.opts.itemClass),doEnable),includeNewWidgets&&(this.opts.disableDrag=!doEnable)},GridStack.prototype.enableResize=function(doEnable,includeNewWidgets){this.resizable(this.container.children("."+this.opts.itemClass),doEnable),includeNewWidgets&&(this.opts.disableResize=!doEnable)},GridStack.prototype.disable=function(){this.movable(this.container.children("."+this.opts.itemClass),!1),this.resizable(this.container.children("."+this.opts.itemClass),!1),this.container.trigger("disable")},GridStack.prototype.enable=function(){this.movable(this.container.children("."+this.opts.itemClass),!0),this.resizable(this.container.children("."+this.opts.itemClass),!0),this.container.trigger("enable")},GridStack.prototype.locked=function(el,val){return(el=$(el)).each(function(index,el){var node=(el=$(el)).data("_gridstack_node");void 0!==node&&null!==node&&(node.locked=val||!1,el.attr("data-gs-locked",node.locked?"yes":null))}),this},GridStack.prototype.maxHeight=function(el,val){return(el=$(el)).each(function(index,el){var node=(el=$(el)).data("_gridstack_node");void 0!==node&&null!==node&&(isNaN(val)||(node.maxHeight=val||!1,el.attr("data-gs-max-height",val)))}),this},GridStack.prototype.minHeight=function(el,val){return(el=$(el)).each(function(index,el){var node=(el=$(el)).data("_gridstack_node");void 0!==node&&null!==node&&(isNaN(val)||(node.minHeight=val||!1,el.attr("data-gs-min-height",val)))}),this},GridStack.prototype.maxWidth=function(el,val){return(el=$(el)).each(function(index,el){var node=(el=$(el)).data("_gridstack_node");void 0!==node&&null!==node&&(isNaN(val)||(node.maxWidth=val||!1,el.attr("data-gs-max-width",val)))}),this},GridStack.prototype.minWidth=function(el,val){return(el=$(el)).each(function(index,el){var node=(el=$(el)).data("_gridstack_node");void 0!==node&&null!==node&&(isNaN(val)||(node.minWidth=val||!1,el.attr("data-gs-min-width",val)))}),this},GridStack.prototype._updateElement=function(el,callback){var node=(el=$(el).first()).data("_gridstack_node");if(void 0!==node&&null!==node){var self=this;self.grid.cleanNodes(),self.grid.beginUpdate(node),callback.call(this,el,node),self._updateContainerHeight(),self._triggerChangeEvent(),self.grid.endUpdate()}},GridStack.prototype.resize=function(el,width,height){this._updateElement(el,function(el,node){width=null!==width&&void 0!==width?width:node.width,height=null!==height&&void 0!==height?height:node.height,this.grid.moveNode(node,node.x,node.y,width,height)})},GridStack.prototype.move=function(el,x,y){this._updateElement(el,function(el,node){x=null!==x&&void 0!==x?x:node.x,y=null!==y&&void 0!==y?y:node.y,this.grid.moveNode(node,x,y,node.width,node.height)})},GridStack.prototype.update=function(el,x,y,width,height){this._updateElement(el,function(el,node){x=null!==x&&void 0!==x?x:node.x,y=null!==y&&void 0!==y?y:node.y,width=null!==width&&void 0!==width?width:node.width,height=null!==height&&void 0!==height?height:node.height,this.grid.moveNode(node,x,y,width,height)})},GridStack.prototype.verticalMargin=function(val,noUpdate){if(void 0===val)return this.opts.verticalMargin;var heightData=Utils.parseHeight(val);this.opts.verticalMarginUnit===heightData.unit&&this.opts.height===heightData.height||(this.opts.verticalMarginUnit=heightData.unit,this.opts.verticalMargin=heightData.height,noUpdate||this._updateStyles())},GridStack.prototype.cellHeight=function(val,noUpdate){if(void 0===val){if(this.opts.cellHeight)return this.opts.cellHeight;var o=this.container.children("."+this.opts.itemClass).first();return Math.ceil(o.outerHeight()/o.attr("data-gs-height"))}var heightData=Utils.parseHeight(val);this.opts.cellHeightUnit===heightData.unit&&this.opts.cellHeight===heightData.height||(this.opts.cellHeightUnit=heightData.unit,this.opts.cellHeight=heightData.height,noUpdate||this._updateStyles())},GridStack.prototype.cellWidth=function(){return Math.round(this.container.outerWidth()/this.opts.width)},GridStack.prototype.getCellFromPixel=function(position,useOffset){var containerPos=void 0!==useOffset&&useOffset?this.container.offset():this.container.position(),relativeLeft=position.left-containerPos.left,relativeTop=position.top-containerPos.top,columnWidth=Math.floor(this.container.width()/this.opts.width),rowHeight=Math.floor(this.container.height()/parseInt(this.container.attr("data-gs-current-height")));return{x:Math.floor(relativeLeft/columnWidth),y:Math.floor(relativeTop/rowHeight)}},GridStack.prototype.batchUpdate=function(){this.grid.batchUpdate()},GridStack.prototype.commit=function(){this.grid.commit(),this._updateContainerHeight()},GridStack.prototype.isAreaEmpty=function(x,y,width,height){return this.grid.isAreaEmpty(x,y,width,height)},GridStack.prototype.setStatic=function(staticValue){this.opts.staticGrid=!0===staticValue,this.enableMove(!staticValue),this.enableResize(!staticValue),this._setStaticClass()},GridStack.prototype._setStaticClass=function(){!0===this.opts.staticGrid?this.container.addClass("grid-stack-static"):this.container.removeClass("grid-stack-static")},GridStack.prototype._updateNodeWidths=function(oldWidth,newWidth){this.grid._sortNodes(),this.grid.batchUpdate();for(var node={},i=0;i<this.grid.nodes.length;i++)node=this.grid.nodes[i],this.update(node.el,Math.round(node.x*newWidth/oldWidth),void 0,Math.round(node.width*newWidth/oldWidth),void 0);this.grid.commit()},GridStack.prototype.setGridWidth=function(gridWidth,doNotPropagate){this.container.removeClass("grid-stack-"+this.opts.width),!0!==doNotPropagate&&this._updateNodeWidths(this.opts.width,gridWidth),this.opts.width=gridWidth,this.grid.width=gridWidth,this.container.addClass("grid-stack-"+gridWidth)},GridStackEngine.prototype.batch_update=obsolete(GridStackEngine.prototype.batchUpdate),GridStackEngine.prototype._fix_collisions=obsolete(GridStackEngine.prototype._fixCollisions),GridStackEngine.prototype.is_area_empty=obsolete(GridStackEngine.prototype.isAreaEmpty),GridStackEngine.prototype._sort_nodes=obsolete(GridStackEngine.prototype._sortNodes),GridStackEngine.prototype._pack_nodes=obsolete(GridStackEngine.prototype._packNodes),GridStackEngine.prototype._prepare_node=obsolete(GridStackEngine.prototype._prepareNode),GridStackEngine.prototype.clean_nodes=obsolete(GridStackEngine.prototype.cleanNodes),GridStackEngine.prototype.get_dirty_nodes=obsolete(GridStackEngine.prototype.getDirtyNodes),GridStackEngine.prototype.add_node=obsolete(GridStackEngine.prototype.addNode),GridStackEngine.prototype.remove_node=obsolete(GridStackEngine.prototype.removeNode),GridStackEngine.prototype.can_move_node=obsolete(GridStackEngine.prototype.canMoveNode),GridStackEngine.prototype.move_node=obsolete(GridStackEngine.prototype.moveNode),GridStackEngine.prototype.get_grid_height=obsolete(GridStackEngine.prototype.getGridHeight),GridStackEngine.prototype.begin_update=obsolete(GridStackEngine.prototype.beginUpdate),GridStackEngine.prototype.end_update=obsolete(GridStackEngine.prototype.endUpdate),GridStackEngine.prototype.can_be_placed_with_respect_to_height=obsolete(GridStackEngine.prototype.canBePlacedWithRespectToHeight),GridStack.prototype._trigger_change_event=obsolete(GridStack.prototype._triggerChangeEvent),GridStack.prototype._init_styles=obsolete(GridStack.prototype._initStyles),GridStack.prototype._update_styles=obsolete(GridStack.prototype._updateStyles),GridStack.prototype._update_container_height=obsolete(GridStack.prototype._updateContainerHeight),GridStack.prototype._is_one_column_mode=obsolete(GridStack.prototype._isOneColumnMode),GridStack.prototype._prepare_element=obsolete(GridStack.prototype._prepareElement),GridStack.prototype.set_animation=obsolete(GridStack.prototype.setAnimation),GridStack.prototype.add_widget=obsolete(GridStack.prototype.addWidget),GridStack.prototype.make_widget=obsolete(GridStack.prototype.makeWidget),GridStack.prototype.will_it_fit=obsolete(GridStack.prototype.willItFit),GridStack.prototype.remove_widget=obsolete(GridStack.prototype.removeWidget),GridStack.prototype.remove_all=obsolete(GridStack.prototype.removeAll),GridStack.prototype.min_height=obsolete(GridStack.prototype.minHeight),GridStack.prototype.min_width=obsolete(GridStack.prototype.minWidth),GridStack.prototype._update_element=obsolete(GridStack.prototype._updateElement),GridStack.prototype.cell_height=obsolete(GridStack.prototype.cellHeight),GridStack.prototype.cell_width=obsolete(GridStack.prototype.cellWidth),GridStack.prototype.get_cell_from_pixel=obsolete(GridStack.prototype.getCellFromPixel),GridStack.prototype.batch_update=obsolete(GridStack.prototype.batchUpdate),GridStack.prototype.is_area_empty=obsolete(GridStack.prototype.isAreaEmpty),GridStack.prototype.set_static=obsolete(GridStack.prototype.setStatic),GridStack.prototype._set_static_class=obsolete(GridStack.prototype._setStaticClass),scope.GridStackUI=GridStack,scope.GridStackUI.Utils=Utils,scope.GridStackUI.Engine=GridStackEngine,scope.GridStackUI.GridStackDragDropPlugin=GridStackDragDropPlugin,$.fn.gridstack=function(opts){return this.each(function(){var o=$(this);o.data("gridstack")||o.data("gridstack",new GridStack(this,opts))})},scope.GridStackUI});